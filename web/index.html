<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agent Cron Scheduler</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- ================================================================== -->
  <!-- Header                                                             -->
  <!-- ================================================================== -->
  <header class="app-header">
    <div class="header-left">
      <h1 class="app-title">Agent Cron Scheduler</h1>
    </div>
    <div class="header-right">
      <span class="health-indicator" id="health-indicator">
        <span class="health-dot" id="health-dot"></span>
        <span class="health-text" id="health-text">Connecting...</span>
      </span>
      <span class="uptime" id="uptime-display"></span>
    </div>
  </header>

  <!-- ================================================================== -->
  <!-- Main Content                                                       -->
  <!-- ================================================================== -->
  <main class="main-content">
    <!-- Toolbar -->
    <div class="toolbar">
      <h2 class="section-title">Jobs</h2>
      <button class="btn btn-primary" id="btn-add-job">+ Add Job</button>
    </div>

    <!-- Job Table -->
    <div class="table-container">
      <table class="job-table" id="job-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Schedule</th>
            <th>Enabled</th>
            <th>Last Run</th>
            <th>Next Run</th>
            <th>Exit Code</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="job-table-body">
          <tr class="empty-row">
            <td colspan="7" class="empty-message">Loading jobs...</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Log Viewer -->
    <div class="log-viewer-section" id="log-viewer-section">
      <div class="log-viewer-header">
        <h2 class="section-title">
          Log Viewer
          <span class="log-job-name" id="log-job-name"></span>
        </h2>
        <div class="log-actions">
          <button class="btn btn-sm" id="btn-clear-log">Clear</button>
          <button class="btn btn-sm" id="btn-close-log">Close</button>
        </div>
      </div>
      <div class="log-output" id="log-output"></div>
    </div>
  </main>

  <!-- ================================================================== -->
  <!-- Job Modal (Add / Edit)                                             -->
  <!-- ================================================================== -->
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal" id="job-modal">
      <div class="modal-header">
        <h2 class="modal-title" id="modal-title">Add Job</h2>
        <button class="modal-close" id="modal-close">&times;</button>
      </div>
      <form id="job-form" class="modal-body">
        <input type="hidden" id="form-job-id">

        <div class="form-group">
          <label for="form-name">Name</label>
          <input type="text" id="form-name" required placeholder="my-backup-job" autocomplete="off">
        </div>

        <div class="form-group">
          <label for="form-schedule">Schedule (cron)</label>
          <input type="text" id="form-schedule" required placeholder="*/5 * * * *" autocomplete="off">
          <span class="form-hint">5-field cron: min hour dom month dow</span>
        </div>

        <div class="form-group">
          <label for="form-exec-type">Execution Type</label>
          <select id="form-exec-type">
            <option value="ShellCommand">Shell Command</option>
            <option value="ScriptFile">Script File</option>
          </select>
        </div>

        <div class="form-group">
          <label for="form-exec-value" id="form-exec-value-label">Command</label>
          <input type="text" id="form-exec-value" required placeholder="echo hello" autocomplete="off">
        </div>

        <div class="form-group">
          <label for="form-timezone">Timezone (optional)</label>
          <input type="text" id="form-timezone" placeholder="UTC" autocomplete="off">
          <span class="form-hint">IANA timezone, e.g. America/New_York</span>
        </div>

        <div class="form-group">
          <label for="form-working-dir">Working Directory (optional)</label>
          <input type="text" id="form-working-dir" placeholder="/home/user/project" autocomplete="off">
        </div>

        <div class="form-group">
          <label for="form-env-vars">Environment Variables (optional)</label>
          <textarea id="form-env-vars" rows="3" placeholder="KEY=VALUE&#10;ANOTHER=value2"></textarea>
          <span class="form-hint">One per line: KEY=VALUE</span>
        </div>

        <div class="form-actions">
          <button type="button" class="btn" id="btn-cancel-form">Cancel</button>
          <button type="submit" class="btn btn-primary" id="btn-submit-form">Create Job</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ================================================================== -->
  <!-- Delete Confirmation Modal                                          -->
  <!-- ================================================================== -->
  <div class="modal-overlay" id="delete-overlay">
    <div class="modal modal-sm">
      <div class="modal-header">
        <h2 class="modal-title">Confirm Delete</h2>
        <button class="modal-close" id="delete-modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete job <strong id="delete-job-name"></strong>?</p>
        <p class="text-muted">This action cannot be undone.</p>
        <div class="form-actions">
          <button class="btn" id="btn-cancel-delete">Cancel</button>
          <button class="btn btn-danger" id="btn-confirm-delete">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ================================================================== -->
  <!-- Toast Container                                                    -->
  <!-- ================================================================== -->
  <div class="toast-container" id="toast-container"></div>

  <script src="app.js"></script>
</body>
</html>
